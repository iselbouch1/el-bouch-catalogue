// Toast notification system
function showToast(message, type = 'info') {
  const toast = document.createElement('div');
  toast.className = `toast toast-${type}`;
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#2563eb'};
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    z-index: 9999;
    animation: slideIn 0.3s ease-out;
  `;
  
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.animation = 'slideOut 0.3s ease-out';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// Add CSS animations
const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from {
      transform: translateX(400px);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOut {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(400px);
      opacity: 0;
    }
  }
`;
document.head.appendChild(style);

// Auto-generate slug from name
document.addEventListener('DOMContentLoaded', function() {
  const nameInput = document.querySelector('input[name="name"]');
  const slugInput = document.querySelector('input[name="slug"]');
  
  if (nameInput && slugInput) {
    nameInput.addEventListener('input', function() {
      if (!slugInput.value || slugInput.dataset.autoGenerated === 'true') {
        const slug = this.value
          .toLowerCase()
          .normalize('NFD')
          .replace(/[\u0300-\u036f]/g, '')
          .replace(/[^a-z0-9]+/g, '-')
          .replace(/^-+|-+$/g, '');
        slugInput.value = slug;
        slugInput.dataset.autoGenerated = 'true';
      }
    });
    
    slugInput.addEventListener('input', function() {
      slugInput.dataset.autoGenerated = 'false';
    });
  }
});

// Form validation
document.querySelectorAll('form').forEach(form => {
  form.addEventListener('submit', function(e) {
    const requiredFields = form.querySelectorAll('[required]');
    let isValid = true;
    
    requiredFields.forEach(field => {
      if (!field.value.trim()) {
        isValid = false;
        field.style.borderColor = '#ef4444';
      } else {
        field.style.borderColor = '#e2e8f0';
      }
    });
    
    if (!isValid) {
      e.preventDefault();
      showToast('Veuillez remplir tous les champs obligatoires', 'error');
    }
  });
});

// File upload preview
document.querySelectorAll('input[type="file"]').forEach(input => {
  input.addEventListener('change', function() {
    const file = this.files[0];
    if (file) {
      showToast(`Fichier sélectionné: ${file.name}`, 'success');
    }
  });
});

// Confirm delete actions
document.querySelectorAll('form button.danger').forEach(button => {
  button.closest('form').addEventListener('submit', function(e) {
    if (!confirm('Êtes-vous sûr de vouloir supprimer cet élément ?')) {
      e.preventDefault();
    }
  });
});

console.log('✅ Admin JS loaded');
